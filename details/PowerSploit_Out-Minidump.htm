<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>Out-Minidump (PowerSploit)</title>
    <link rel="stylesheet" type="text/css" href="common/style.css" />
    <script language="JavaScript" type="text/javascript" src="common/script.js"></script>
  </head>
  <body>
    <h1 class="title">Out-Minidump (PowerSploit)</h1>
      <h2 class="toc"><a href="#toc" class="collapse" id="a-toc" onclick="showhide('toc');">-</a> <a name="toc">目次</a></h2>
        <div class="toc" id="div-toc">
          <ul>
            <li><a href="#Summary">ツール概要</a></li>
            <li><a href="#ExecCondition">ツール動作概要</a></li>
            <li><a href="#Findings">ログから得られる情報</a></li>
            <li><a href="#SuccessCondition">実行成功時に確認できる痕跡</a></li>
            <li><a href="#KeyEvents">実行時に記録される主要な情報</a></li>
            <li><a href="#HostDetails">詳細：ホスト</a></li>
          </ul>
          <p class="toc_command"><a href="#" onclick="collapseall('s');">全てのセクションを開く</a> | <a href="#" onclick="collapseall('h');">全てのセクションを閉じる</a></p>
          <hr class="section_divider" />
        </div>
      <h2 class="section"><a href="#Summary" class="collapse" id="a-Summary" onclick="showhide('Summary');">-</a> <a name="Summary">ツール概要</a></h2>
        <div class="section" id="div-Summary">
          <dl class="table">
            <dt class="table">カテゴリ</dt>
              <dd class="table">パスワード、ハッシュの入手</dd>
            <dt class="table">説明</dt>
              <dd class="table">メモリ上のプロセスをダンプする。</dd>
            <dt class="table">攻撃時における想定利用例</dt>
              <dd class="table">ユーザーのパスワードを取得し、不正ログインに使用する。</dd>
          </dl>
        </div>
      <h2 class="section"><a href="#ExecCondition" class="collapse" id="a-ExecCondition" onclick="showhide('ExecCondition');">-</a> <a name="ExecCondition">ツール動作概要</a></h2>
        <div class="section" id="div-ExecCondition">
          <table class="border">
            <thead>
              <tr class="border">
                <th class="border_header">項目</th>
                <th class="border_header">内容</th>
              </tr>
            </thead>
            <tbody>
              <tr class="border">
                <td class="border_header">OS</td>
                <td class="border">Windows</td>
              </tr>
              <tr class="border">
                <td class="border_header">ドメインへの所属</td>
                <td class="border">不要</td>
              </tr>
              <tr class="border">
                <td class="border_header">権限</td>
                <td class="border">管理者ユーザー</td>
              </tr>
            </tbody>
          </table>
        </div>
      <h2 class="section"><a href="#Findings" class="collapse" id="a-Findings" onclick="showhide('Findings');">-</a> <a name="Findings">ログから得られる情報</a></h2>
        <div class="section" id="div-Findings">
          <dl class="table">
            <dt class="table">標準設定</dt>
              <dd class="table"><ul>
                <li>ホスト<ul>
                  <li>実行履歴 (Prefetch)</li>
                  <li>実行されたスクリプト・コマンドの内容 (Windows 10のみ。「Microsoft-Windows-PowerShell/Operational」およびC:\Users\[ユーザー名]\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txtに記録される)</li>
                  </ul></li>
                </ul></dd>
            <dt class="table">追加設定</dt>
              <dd class="table"><ul>
                <li>ホスト<ul>
                  <li>実行履歴 (監査ポリシー, Sysmon)</li>
                  <li>「プロセス メモリからの読み取り」が発生していること (監査ポリシー)</li>
                  <li>lsassのダンプファイルが作成されたこと (監査ポリシー, MFT, USNジャーナル)</li>
                  <li>実行されたスクリプト・コマンドの内容 (Windows 7にWindows Management Framework 5.0をインストールした場合。「Microsoft-Windows-PowerShell/Operational」およびC:\Users\[ユーザー名]\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txtに記録される)</li>
                  </ul></li>
                </ul></dd>
          </dl>
        </div>
      <h2 class="section"><a href="#SuccessCondition" class="collapse" id="a-SuccessCondition" onclick="showhide('SuccessCondition');">-</a> <a name="SuccessCondition">実行成功時に確認できる痕跡</a></h2>
        <div class="section" id="div-SuccessCondition">
          <ul>
            <li>lsassのダンプファイル(lsass_[lsassのPID].dmp)が作成されている。</li>
          </ul>
        </div>
      <h2 class="section"><a href="#KeyEvents" class="collapse" id="a-KeyEvents" onclick="showhide('KeyEvents');">-</a> <a name="KeyEvents">実行時に記録される主要な情報</a></h2>
        <div class="section" id="div-KeyEvents">
          <h3 class="subsection"><a href="#KeyEvents-Host" class="collapse" id="a-KeyEvents-Host" onclick="showhide('KeyEvents-Host');">-</a> <a name="KeyEvents-Host">ホスト</a></h3>
            <div class="section" id="div-KeyEvents-Host">
              <h4>イベントログ</h4>
                <table class="border">
                  <thead>
                    <tr class="border">
                      <th class="border_header">#</th>
                      <th class="border_header">ログ</th>
                      <th class="border_header">イベントID</th>
                      <th class="border_header">タスクのカテゴリ</th>
                      <th class="border_header">イベント内容</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="border">
                      <td class="border">1</td>
                      <td class="border">Microsoft-Windows-Sysmon/Operational</td>
                      <td class="border">1</td>
                      <td class="border">Process Create (rule: ProcessCreate)</td>
                      <td class="border">Process Create.<ul>
                        <li><span class="strong">UtcTime</span>: プロセス実行日時 (UTC)</li>
                        <li><span class="strong">ProcessGuid/ProcessId</span>: プロセスID</li>
                        <li><span class="strong">CommandLine</span>: 実行コマンドのコマンドライン (通常はpowershell.exeのパスのみ。但し、スクリプトを引数で指定した場合、その引数がコマンドラインに残る場合がある)</li>
                        <li><span class="strong">Image</span>: 実行ファイルのパス (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                        <li><span class="strong">User</span>: 実行ユーザー</li>
                        </ul></td>
                    </tr>
                    <tr class="border">
                      <td class="border">2</td>
                      <td class="border">Microsoft-Windows-Sysmon/Operational</td>
                      <td class="border">11</td>
                      <td class="border">File created (rule: FileCreate)</td>
                      <td class="border">File created.<ul>
                        <li><span class="strong">ProcessGuid/ProcessId</span>: プロセスID</li>
                        <li><span class="strong">Image</span>: 実行ファイルのパス (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                        <li><span class="strong">TargetFilename</span>: 作成されたファイル ([PowerSploitのパス]\lsass_[lsassのPID].dmp)</li>
                        <li><span class="strong">CreationUtcTime</span>: ファイル作成日時 (UTC)</li>
                        </ul></td>
                    </tr>
                    <tr class="border">
                      <td class="border">3</td>
                      <td class="border">セキュリティ</td>
                      <td class="border">4663</td>
                      <td class="border">ファイル システム</td>
                      <td class="border">オブジェクトへのアクセスが試行されました。<ul>
                        <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                        <li><span class="strong">オブジェクト > オブジェクトの種類</span>: 対象の区分 (Process)</li>
                        <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (\Device\HarddiskVolume2\Windows\System32\lsass.exe)</li>
                        <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                        <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (プロセス メモリからの読み取り)</li>
                        </ul></td>
                    </tr>
                    <tr class="border">
                      <td class="border">4</td>
                      <td class="border">セキュリティ</td>
                      <td class="border">4689</td>
                      <td class="border">プロセス終了</td>
                      <td class="border">プロセスが終了しました。<ul>
                        <li><span class="strong">ログの日時</span>: プロセス終了日時 (ローカル時刻)</li>
                        <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                        <li><span class="strong">プロセス情報 > プロセス名</span>: 実行ファイルのパス (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                        <li><span class="strong">プロセス情報 > 終了状態</span>: プロセスの戻り値</li>
                        </ul></td>
                    </tr>
                  </tbody>
                </table>
              <h4>MFT</h4>
                <table class="border">
                  <thead>
                    <tr class="border">
                      <th class="border_header">#</th>
                      <th class="border_header">パス</th>
                      <th class="border_header">ヘッダフラグ</th>
                      <th class="border_header">有効</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="border">
                      <td class="border">1</td>
                      <td class="border">[PowerSploitのパス]\lsass_[lsassのPID].dmp</td>
                      <td class="border">FILE</td>
                      <td class="border">ALLOCATED</td>
                    </tr>
                  </tbody>
                </table>
              <h4>Prefetch</h4>
                <ul>
                  <li>C:\Windows\Prefetch\POWERSHELL.EXE-[文字列].pf</li>
                </ul>
              <h4>UserAssist</h4>
                <table class="border">
                  <thead>
                    <tr class="border">
                      <th class="border_header">#</th>
                      <th class="border_header">Registry</th>
                      <th class="border_header">Data</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="border">
                      <td class="border">1</td>
                      <td class="border">\REGISTRY\USER\[ユーザーSID]\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{[GUID]}\Count\{[GUID]}\JvaqbjfCbjreFuryy\i1.0\cbjrefuryy.rkr</td>
                      <td class="border">初回実行日時、累計実行回数</td>
                    </tr>
                  </tbody>
                </table>
              <h4>USNジャーナル</h4>
                <table class="border">
                  <thead>
                    <tr class="border">
                      <th class="border_header">#</th>
                      <th class="border_header">ファイル名</th>
                      <th class="border_header">処理</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="border">
                      <td class="border">1</td>
                      <td class="border">lsass_[lsassのPID].dmp</td>
                      <td class="border">FILE_CREATE</td>
                    </tr>
                    <tr class="border">
                      <td class="border">2</td>
                      <td class="border">lsass_[lsassのPID].dmp</td>
                      <td class="border">DATA_EXTEND+FILE_CREATE</td>
                    </tr>
                    <tr class="border">
                      <td class="border">3</td>
                      <td class="border">lsass_[lsassのPID].dmp</td>
                      <td class="border">DATA_EXTEND+DATA_OVERWRITE+FILE_CREATE</td>
                    </tr>
                    <tr class="border">
                      <td class="border">4</td>
                      <td class="border">lsass_[lsassのPID].dmp</td>
                      <td class="border">CLOSE+DATA_EXTEND+DATA_OVERWRITE+FILE_CREATE</td>
                    </tr>
                  </tbody>
                </table>
            </div>
        </div>
        <hr class="section_divider">
      <h2 class="section"><a href="#HostDetails" class="collapse" id="a-HostDetails" onclick="showhide('HostDetails');">-</a> <a name="HostDetails">詳細：ホスト</a></h2>
        <div class="section" id="div-HostDetails">
          <h3 class="subsection"><a href="#HostDetails-EventLogs" class="collapse" id="a-HostDetails-EventLogs" onclick="showhide('HostDetails-EventLogs');">-</a> <a name="HostDetails-EventLogs">イベントログ</a></h3>
            <div class="section" id="div-HostDetails-EventLogs">
              <table class="border">
                <thead>
                  <tr class="border">
                    <th class="border_header">#</th>
                    <th class="border_header">イベントログ</th>
                    <th class="border_header">イベントID</th>
                    <th class="border_header">タスクのカテゴリ</th>
                    <th class="border_header">イベント内容</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="border">
                    <td class="border" rowspan="5">1</td>
                    <td class="border">Microsoft-Windows-Sysmon/Operational</td>
                    <td class="border">1</td>
                    <td class="border">Process Create (rule: ProcessCreate)</td>
                    <td class="border">Process Create.<ul>
                      <li><span class="strong">UtcTime</span>: プロセス実行日時 (UTC)</li>
                      <li><span class="strong">ProcessGuid/ProcessId</span>: プロセスID</li>
                      <li><span class="strong">Image</span>: 実行ファイルのパス (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                      <li><span class="strong">CommandLine</span>: 実行コマンドのコマンドライン (通常はpowershell.exeのパスのみ。但し、スクリプトを引数で指定した場合、その引数がコマンドラインに残る場合がある)</li>
                      <li><span class="strong">User</span>: 実行ユーザー</li>
                      <li><span class="strong">LogonGuid/LogonId</span>: ログオンセッションのID</li>
                      <li><span class="strong">Hashes</span>: 実行ファイルのハッシュ値</li>
                      <li><span class="strong">ParentProcessGuid/ParentProcessId</span>: 親プロセスのプロセスID</li>
                      <li><span class="strong">ParentImage</span>: 親プロセスの実行ファイル</li>
                      <li><span class="strong">ParentCommandLine</span>: 親プロセスのコマンドライン</li>
                      </ul></td>
                  </tr>
                  <tr class="border">
                    <!-- rowspan -->
                    <td class="border">セキュリティ</td>
                    <td class="border">4688</td>
                    <td class="border">プロセス作成</td>
                    <td class="border">新しいプロセスが作成されました。<ul>
                      <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                      <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                      <li><span class="strong">プロセス情報 > トークン昇格の種類</span>: 権限昇格の有無 (1)</li>
                      <li><span class="strong">プロセス情報 > 新しいプロセスID</span>: プロセスID (16進数)</li>
                      <li><span class="strong">プロセス情報 > 新しいプロセス名</span>: 実行ファイルのパス (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                      <li><span class="strong">プロセス情報 > 作成元プロセスID</span>: 新プロセスを作成した親プロセスのプロセスID。Windows 7では「クリエイター プロセスID」</li>
                      <li><span class="strong">プロセス情報 > 作成元プロセス名</span>: 新プロセスを作成した親プロセスのパス (C:\Windows\explorer.exe)</li>
                      <li><span class="strong">プロセス情報 > 必須ラベル</span>: 権限昇格の要否 (Mandatory Label\High Mandatory Level)</li>
                      <li><span class="strong">ログの日時</span>: プロセス実行日時 (ローカル時刻)</li>
                      </ul></td>
                  </tr>
                  <tr class="border">
                    <!-- rowspan -->
                    <td class="border">Microsoft-Windows-PowerShell/Operational</td>
                    <td class="border">40961</td>
                    <td class="border">PowerShell コンソールの起動</td>
                    <td class="border">PowerShell コンソールを起動しています</td>
                </tr>
                <tr class="border">
                  <!-- rowspan -->
                  <td class="border">Microsoft-Windows-PowerShell/Operational</td>
                  <td class="border">53504</td>
                  <td class="border">PowerShell 名前付きパイプ IPC</td>
                  <td class="border">Windows PowerShell は、[ドメイン] のプロセス [プロセスID] で IPC リッスン スレッドを開始しました。</td>
              </tr>
              <tr class="border">
                <!-- rowspan -->
                <td class="border">Microsoft-Windows-PowerShell/Operational</td>
                <td class="border">40962</td>
                <td class="border">PowerShell コンソールの起動</td>
                <td class="border">PowerShell コンソールはユーザー入力を受け入れられるようになりました</td>
            </tr>
            <tr class="border">
              <td class="border" rowspan="1">2</td>
              <td class="border">Microsoft-Windows-Sysmon/Operational</td>
              <td class="border">13</td>
              <td class="border">Registry value set (rule: RegistryEvent)</td>
              <td class="border">Registry value set.<ul>
                <li><span class="strong">EventType</span>: 処理の種類 (SetValue)</li>
                <li><span class="strong">Image</span>: 実行ファイルのパス (C:\Windows\Explorer.EXE)</li>
                <li><span class="strong">ProcessGuid/ProcessId</span>: プロセスID</li>
                <li><span class="strong">TargetObject</span>: 書き込み先のレジストリ値 (\REGISTRY\USER\[ユーザーSID]\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{[GUID]}\Count\{[GUID]}\JvaqbjfCbjreFuryy\i1.0\cbjrefuryy.rkr)</li>
                <li><span class="strong">Details</span>: レジストリに書き込まれた設定値 (Binary Data)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <td class="border" rowspan="1">3</td>
              <td class="border">Microsoft-Windows-Sysmon/Operational</td>
              <td class="border">10</td>
              <td class="border">Process accessed (rule: ProcessAccess)</td>
              <td class="border">Process accessed.<ul>
                <li><span class="strong">GrantedAccess</span>: 許可されたアクセスの内容</li>
                <li><span class="strong">SourceImage</span>: アクセス元プロセスのパス (C:\Windows\Explorer.EXE)</li>
                <li><span class="strong">SourceProcessGUID/SourceProcessId/SourceThreadId</span>: アクセス元プロセスのプロセス/スレッドID</li>
                <li><span class="strong">TargetImage</span>: アクセス先プロセスのパス (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                <li><span class="strong">TargetProcessGUID/TargetProcessId</span>: アクセス先プロセスのプロセスID</li>
                </ul></td>
            </tr>
            <tr class="border">
              <td class="border" rowspan="1">4</td>
              <td class="border">Microsoft-Windows-Sysmon/Operational</td>
              <td class="border">10</td>
              <td class="border">Process accessed (rule: ProcessAccess)</td>
              <td class="border">Process accessed.<ul>
                <li><span class="strong">GrantedAccess</span>: 許可されたアクセスの内容</li>
                <li><span class="strong">SourceImage</span>: アクセス元プロセスのパス (C:\Windows\system32\lsass.exe)</li>
                <li><span class="strong">SourceProcessGUID/SourceProcessId/SourceThreadId</span>: アクセス元プロセスのプロセス/スレッドID</li>
                <li><span class="strong">TargetImage</span>: アクセス先プロセスのパス (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                <li><span class="strong">TargetProcessGUID/TargetProcessId</span>: アクセス先プロセスのプロセスID</li>
                </ul></td>
            </tr>
            <tr class="border">
              <td class="border" rowspan="4">5</td>
              <td class="border">Microsoft-Windows-Sysmon/Operational</td>
              <td class="border">11</td>
              <td class="border">File created (rule: FileCreate)</td>
              <td class="border">File created.<ul>
                <li><span class="strong">ProcessGuid/ProcessId</span>: プロセスID</li>
                <li><span class="strong">Image</span>: 実行ファイルのパス (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                <li><span class="strong">TargetFilename</span>: 作成されたファイル (C:\Users\[ユーザー名]\AppData\Local\Temp\[ランダム文字列].ps1)</li>
                <li><span class="strong">CreationUtcTime</span>: ファイル作成日時 (UTC)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <!-- rowspan -->
              <td class="border">セキュリティ</td>
              <td class="border">4656</td>
              <td class="border">ファイル システム / その他のオブジェクト アクセス イベント</td>
              <td class="border">オブジェクトに対するハンドルが要求されました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > オブジェクトの種類</span>: ファイルの種類 (File)</li>
                <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (C:\Users\[ユーザー名]\AppData\Local\Temp\[ランダム文字列].ps1)</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (WriteDataまたはAddFileを含む)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <!-- rowspan -->
              <td class="border">セキュリティ</td>
              <td class="border">4663</td>
              <td class="border">ファイル システム</td>
              <td class="border">オブジェクトへのアクセスが試行されました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > オブジェクトの種類</span>: 対象の区分 (File)</li>
                <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (C:\Users\[ユーザー名]\AppData\Local\Temp\[ランダム文字列].ps1)</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID (直前のイベントID: 4656で取得されたハンドルID)</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (WriteAttributes)</li>
                <li><span class="strong">成功の監査</span>: 成否 (アクセス成功)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <!-- rowspan -->
              <td class="border">セキュリティ</td>
              <td class="border">4658</td>
              <td class="border">ファイル システム</td>
              <td class="border">オブジェクトに対するハンドルが閉じました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: オブジェクトを要求したプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <td class="border" rowspan="4">6</td>
              <td class="border">Microsoft-Windows-Sysmon/Operational</td>
              <td class="border">11</td>
              <td class="border">File created (rule: FileCreate)</td>
              <td class="border">File created.<ul>
                <li><span class="strong">ProcessGuid/ProcessId</span>: プロセスID</li>
                <li><span class="strong">Image</span>: 実行ファイルのパス (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                <li><span class="strong">TargetFilename</span>: 作成されたファイル (C:\Users\[ユーザー名]\AppData\Local\Temp\[ランダム文字列].psm1)</li>
                <li><span class="strong">CreationUtcTime</span>: ファイル作成日時 (UTC)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <!-- rowspan -->
              <td class="border">セキュリティ</td>
              <td class="border">4656</td>
              <td class="border">ファイル システム / その他のオブジェクト アクセス イベント</td>
              <td class="border">オブジェクトに対するハンドルが要求されました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > オブジェクトの種類</span>: ファイルの種類 (File)</li>
                <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (C:\Users\[ユーザー名]\AppData\Local\Temp\[ランダム文字列].psm1)</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (WriteDataまたはAddFile, WriteAttributesを含む)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <!-- rowspan -->
              <td class="border">セキュリティ</td>
              <td class="border">4663</td>
              <td class="border">ファイル システム</td>
              <td class="border">オブジェクトへのアクセスが試行されました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > オブジェクトの種類</span>: 対象の区分 (File)</li>
                <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (C:\Users\[ユーザー名]\AppData\Local\Temp\[ランダム文字列].psm1)</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID (直前のイベントID: 4656で取得されたハンドルID)</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限</li>
                <li><span class="strong">成功の監査</span>: 成否 (アクセス成功)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <!-- rowspan -->
              <td class="border">セキュリティ</td>
              <td class="border">4658</td>
              <td class="border">ファイル システム</td>
              <td class="border">オブジェクトに対するハンドルが閉じました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: オブジェクトを要求したプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <td class="border" rowspan="3">7</td>
              <td class="border">セキュリティ</td>
              <td class="border">4656</td>
              <td class="border">ファイル システム / その他のオブジェクト アクセス イベント</td>
              <td class="border">オブジェクトに対するハンドルが要求されました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > オブジェクトの種類</span>: ファイルの種類 (File)</li>
                <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (C:\Users\[ユーザー名]\AppData\Local\Temp\[ランダム文字列].ps1)</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (DELETEを含む)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <!-- rowspan -->
              <td class="border">セキュリティ</td>
              <td class="border">4663</td>
              <td class="border">ファイル システム</td>
              <td class="border">オブジェクトへのアクセスが試行されました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > オブジェクトの種類</span>: 対象の区分 (File)</li>
                <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (C:\Users\[ユーザー名]\AppData\Local\Temp\[ランダム文字列].ps1)</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID (直前のイベントID: 4656で取得されたハンドルID)</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (DELETE)</li>
                <li><span class="strong">成功の監査</span>: 成否 (アクセス成功)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <!-- rowspan -->
              <td class="border">セキュリティ</td>
              <td class="border">4658</td>
              <td class="border">ファイル システム</td>
              <td class="border">オブジェクトに対するハンドルが閉じました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: オブジェクトを要求したプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <td class="border" rowspan="3">8</td>
              <td class="border">セキュリティ</td>
              <td class="border">4656</td>
              <td class="border">ファイル システム / その他のオブジェクト アクセス イベント</td>
              <td class="border">オブジェクトに対するハンドルが要求されました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > オブジェクトの種類</span>: ファイルの種類 (File)</li>
                <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (C:\Users\[ユーザー名]\AppData\Local\Temp\[ランダム文字列].psm1)</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (DELETEを含む)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <!-- rowspan -->
              <td class="border">セキュリティ</td>
              <td class="border">4663</td>
              <td class="border">ファイル システム</td>
              <td class="border">オブジェクトへのアクセスが試行されました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > オブジェクトの種類</span>: 対象の区分 (File)</li>
                <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (C:\Users\[ユーザー名]\AppData\Local\Temp\[ランダム文字列].psm1)</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID (直前のイベントID: 4656で取得されたハンドルID)</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                <li><span class="strong">アクセス要求情報 > アクセス</span>: 要求された権限</li>
                <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (DELETE)</li>
                <li><span class="strong">成功の監査</span>: 成否 (アクセス成功)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <!-- rowspan -->
              <td class="border">セキュリティ</td>
              <td class="border">4658</td>
              <td class="border">ファイル システム</td>
              <td class="border">オブジェクトに対するハンドルが閉じました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: オブジェクトを要求したプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <td class="border" rowspan="3">9</td>
              <td class="border">セキュリティ</td>
              <td class="border">4656</td>
              <td class="border">ファイル システム / その他のオブジェクト アクセス イベント</td>
              <td class="border">オブジェクトに対するハンドルが要求されました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > オブジェクトの種類</span>: ファイルの種類 (File)</li>
                <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (C:\Windows\Prefetch\POWERSHELL.EXE-[文字列].pf)</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\svchost.exe)</li>
                <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (WriteDataまたはAddFile, AppendDataを含む)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <!-- rowspan -->
              <td class="border">セキュリティ</td>
              <td class="border">4663</td>
              <td class="border">ファイル システム</td>
              <td class="border">オブジェクトへのアクセスが試行されました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > オブジェクトの種類</span>: 対象の区分 (File)</li>
                <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (C:\Windows\Prefetch\POWERSHELL.EXE-[文字列].pf)</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID (直前のイベントID: 4656で取得されたハンドルID)</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\svchost.exe)</li>
                <li><span class="strong">アクセス要求情報 > アクセス</span>: 要求された権限</li>
                <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (WriteDataまたはAddFile, AppendData)</li>
                <li><span class="strong">成功の監査</span>: 成否 (アクセス成功)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <!-- rowspan -->
              <td class="border">セキュリティ</td>
              <td class="border">4658</td>
              <td class="border">ファイル システム</td>
              <td class="border">オブジェクトに対するハンドルが閉じました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: オブジェクトを要求したプロセス名 (C:\Windows\System32\svchost.exe)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <td class="border" rowspan="3">10</td>
              <td class="border">セキュリティ</td>
              <td class="border">4656</td>
              <td class="border">ファイル システム / その他のオブジェクト アクセス イベント</td>
              <td class="border">オブジェクトに対するハンドルが要求されました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > オブジェクトの種類</span>: ファイルの種類 (File)</li>
                <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (C:\Users\[ユーザー名]\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_History.txt)</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (WriteDataまたはAddFile, AppendDataを含む)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <!-- rowspan -->
              <td class="border">セキュリティ</td>
              <td class="border">4663</td>
              <td class="border">ファイル システム</td>
              <td class="border">オブジェクトへのアクセスが試行されました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > オブジェクトの種類</span>: 対象の区分 (File)</li>
                <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (C:\Users\[ユーザー名]\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_History.txt)</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID (直前のイベントID: 4656で取得されたハンドルID)</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                <li><span class="strong">アクセス要求情報 > アクセス</span>: 要求された権限</li>
                <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (WriteDataまたはAddFile, AppendData)</li>
                <li><span class="strong">成功の監査</span>: 成否 (アクセス成功)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <!-- rowspan -->
              <td class="border">セキュリティ</td>
              <td class="border">4658</td>
              <td class="border">ファイル システム</td>
              <td class="border">オブジェクトに対するハンドルが閉じました。<ul>
                <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
                <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
                <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
                <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
                <li><span class="strong">プロセス情報 > プロセス名</span>: オブジェクトを要求したプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
                </ul></td>
            </tr>
            <tr class="border">
              <td class="border" rowspan="1">11</td>
              <td class="border">Microsoft-Windows-PowerShell/Operational</td>
              <td class="border">4104</td>
              <td class="border">リモート コマンドを実行します</td>
              <td class="border">Scriptblock テキストを作成しています</td>
          </tr>
          <tr class="border">
            <td class="border" rowspan="6">12</td>
            <td class="border">Microsoft-Windows-Sysmon/Operational</td>
            <td class="border">10</td>
            <td class="border">Process accessed (rule: ProcessAccess)</td>
            <td class="border">Process accessed.<ul>
              <li><span class="strong">SourceImage</span>: アクセス元プロセスのパス (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
              <li><span class="strong">SourceProcessGUID/SourceProcessId/SourceThreadId</span>: アクセス元プロセスのプロセス/スレッドID</li>
              <li><span class="strong">TargetImage</span>: アクセス先プロセスのパス (C:\Windows\system32\lsass.exe)</li>
              <li><span class="strong">TargetProcessGUID/TargetProcessId</span>: アクセス先プロセスのプロセスID</li>
              <li><span class="strong">GrantedAccess</span>: 許可されたアクセスの内容 (0x1F3FFF, 0x1FFFFF)</li>
              </ul></td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">セキュリティ</td>
            <td class="border">4690</td>
            <td class="border">ハンドル操作</td>
            <td class="border">特定プロセスからハンドルが複製された。<ul>
              <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
              <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
              <li><span class="strong">複製元ハンドル情報 > 複製元ハンドルID</span>: 複製元のハンドルID</li>
              <li><span class="strong">複製元ハンドル情報 > 複製元プロセスID</span>: 複製元のプロセスID (PowerShellのプロセスID)</li>
              <li><span class="strong">新しいハンドル情報 > 複製先ハンドルID</span>: 複製先の新規ハンドルID</li>
              <li><span class="strong">新しいハンドル情報 > 複製先プロセスID</span>: 新規ハンドルIDを持つ複製先のプロセスID (0x4=SystemのプロセスID)</li>
              </ul>
              <span class="strong">備考</span>: PowerShellからSystem (PID 0x4)へハンドルが複製される。</td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">セキュリティ</td>
            <td class="border">4658</td>
            <td class="border">カーネル オブジェクト</td>
            <td class="border">オブジェクトに対するハンドルが閉じました。<ul>
              <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
              <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
              <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID (直前のイベントID: 4690でSystemへ複製されたハンドルID)</li>
              <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
              <li><span class="strong">プロセス情報 > プロセス名</span>: オブジェクトを要求したプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
              </ul></td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">セキュリティ</td>
            <td class="border">4656</td>
            <td class="border">カーネル オブジェクト</td>
            <td class="border">オブジェクトに対するハンドルが要求されました。<ul>
              <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
              <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
              <li><span class="strong">オブジェクト > オブジェクトの種類</span>: ファイルの種類 (Process)</li>
              <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (\Device\HarddiskVolume2\Windows\System32\lsass.exe)</li>
              <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
              <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
              <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
              <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (プロセス メモリからの読み取り を含む)</li>
              </ul></td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">セキュリティ</td>
            <td class="border">4690</td>
            <td class="border">ハンドル操作</td>
            <td class="border">特定プロセスからハンドルが複製された。<ul>
              <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
              <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
              <li><span class="strong">複製元ハンドル情報 > 複製元ハンドルID</span>: 複製元のハンドルID</li>
              <li><span class="strong">複製元ハンドル情報 > 複製元プロセスID</span>: 複製元のプロセスID (PowerShellのプロセスID)</li>
              <li><span class="strong">新しいハンドル情報 > 複製先ハンドルID</span>: 複製先の新規ハンドルID</li>
              <li><span class="strong">新しいハンドル情報 > 複製先プロセスID</span>: 新規ハンドルIDを持つ複製先のプロセスID (0x4=SystemのプロセスID)</li>
              </ul></td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">セキュリティ</td>
            <td class="border">4658</td>
            <td class="border">カーネル オブジェクト</td>
            <td class="border">オブジェクトに対するハンドルが閉じました。<ul>
              <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
              <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
              <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID (直前のイベントID: 4690でSystemへ複製されたハンドルID)</li>
              <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
              <li><span class="strong">プロセス情報 > プロセス名</span>: オブジェクトを要求したプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
              </ul></td>
          </tr>
          <tr class="border">
            <td class="border" rowspan="7">13</td>
            <td class="border">Microsoft-Windows-Sysmon/Operational</td>
            <td class="border">11</td>
            <td class="border">File created (rule: FileCreate)</td>
            <td class="border">File created.<ul>
              <li><span class="strong">ProcessGuid/ProcessId</span>: プロセスID</li>
              <li><span class="strong">Image</span>: 実行ファイルのパス (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
              <li><span class="strong">TargetFilename</span>: 作成されたファイル ([PowerSploitのパス]\lsass_[lsassのPID].dmp)</li>
              <li><span class="strong">CreationUtcTime</span>: ファイル作成日時 (UTC)</li>
              </ul></td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">セキュリティ</td>
            <td class="border">4656</td>
            <td class="border">ファイル システム / その他のオブジェクト アクセス イベント</td>
            <td class="border">オブジェクトに対するハンドルが要求されました。<ul>
              <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
              <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
              <li><span class="strong">オブジェクト > オブジェクトの種類</span>: ファイルの種類 (File)</li>
              <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 ([PowerSploitのパス]\lsass_[lsassのPID].dmp)</li>
              <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
              <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
              <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
              <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (WriteDataまたはAddFile, AppendDataを含む)</li>
              </ul></td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">セキュリティ</td>
            <td class="border">4656</td>
            <td class="border">カーネル オブジェクト</td>
            <td class="border">オブジェクトに対するハンドルが要求されました。<ul>
              <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
              <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
              <li><span class="strong">オブジェクト > オブジェクトの種類</span>: ファイルの種類 (Process)</li>
              <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (\Device\HarddiskVolume2\Windows\System32\lsass.exe)</li>
              <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
              <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
              <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
              <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (プロセス メモリからの読み取り を含む)</li>
              </ul></td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">セキュリティ</td>
            <td class="border">4663</td>
            <td class="border">ファイル システム</td>
            <td class="border">オブジェクトへのアクセスが試行されました。<ul>
              <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
              <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
              <li><span class="strong">オブジェクト > オブジェクトの種類</span>: 対象の区分 (Process)</li>
              <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 (\Device\HarddiskVolume2\Windows\System32\lsass.exe)</li>
              <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID (直前のイベントID: 4656で取得されたハンドルID)</li>
              <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
              <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
              <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (プロセス メモリからの読み取り)</li>
              <li><span class="strong">成功の監査</span>: 成否 (アクセス成功)</li>
              </ul></td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">セキュリティ</td>
            <td class="border">4658</td>
            <td class="border">カーネル オブジェクト</td>
            <td class="border">オブジェクトに対するハンドルが閉じました。<ul>
              <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
              <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
              <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID (直前のイベントID: 4656で取得されたハンドルID)</li>
              <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
              <li><span class="strong">プロセス情報 > プロセス名</span>: オブジェクトを要求したプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
              </ul></td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">セキュリティ</td>
            <td class="border">4663</td>
            <td class="border">ファイル システム</td>
            <td class="border">オブジェクトへのアクセスが試行されました。<ul>
              <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
              <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
              <li><span class="strong">オブジェクト > オブジェクトの種類</span>: 対象の区分 (File)</li>
              <li><span class="strong">オブジェクト > オブジェクト名</span>: 対象のファイル名 ([PowerSploitのパス]\lsass_[lsassのPID].dmp)</li>
              <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID (lsass_[lsassのPID].dmpに対するイベントID: 4656で取得されたハンドルID)</li>
              <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
              <li><span class="strong">プロセス情報 > プロセス名</span>: ハンドルを閉じたプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
              <li><span class="strong">アクセス要求情報 > アクセス/アクセス理由/アクセス マスク</span>: 要求された権限 (WriteDataまたはAddFile, AppendDataを含む)</li>
              <li><span class="strong">成功の監査</span>: 成否 (アクセス成功)</li>
              </ul></td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">セキュリティ</td>
            <td class="border">4658</td>
            <td class="border">ファイル システム</td>
            <td class="border">オブジェクトに対するハンドルが閉じました。<ul>
              <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
              <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
              <li><span class="strong">オブジェクト > ハンドルID</span>: 当該ハンドルの識別ID</li>
              <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
              <li><span class="strong">プロセス情報 > プロセス名</span>: オブジェクトを要求したプロセス名 (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
              </ul></td>
          </tr>
          <tr class="border">
            <td class="border" rowspan="2">14</td>
            <td class="border">Microsoft-Windows-Sysmon/Operational</td>
            <td class="border">5</td>
            <td class="border">Process terminated (rule: ProcessTerminate)</td>
            <td class="border">Process terminated.<ul>
              <li><span class="strong">UtcTime</span>: プロセス終了日時 (UTC)</li>
              <li><span class="strong">ProcessGuid/ProcessId</span>: プロセスID</li>
              <li><span class="strong">Image</span>: 実行ファイルのパス (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
              </ul></td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">セキュリティ</td>
            <td class="border">4689</td>
            <td class="border">プロセス終了</td>
            <td class="border">プロセスが終了しました。<ul>
              <li><span class="strong">ログの日時</span>: プロセス終了日時 (ローカル時刻)</li>
              <li><span class="strong">サブジェクト > セキュリティID/アカウント名/アカウント ドメイン</span>: 実行したユーザーSID/アカウント名/ドメイン</li>
              <li><span class="strong">サブジェクト > ログオンID</span>: プロセスを実行したユーザーのセッションID</li>
              <li><span class="strong">プロセス情報 > プロセスID</span>: プロセスID (16進数)</li>
              <li><span class="strong">プロセス情報 > プロセス名</span>: 実行ファイルのパス (C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe)</li>
              <li><span class="strong">プロセス情報 > 終了状態</span>: プロセスの戻り値</li>
              </ul></td>
          </tr>
        </tbody>
      </table>
    </div>
  <h3 class="subsection"><a href="#HostDetails-MFT" class="collapse" id="a-HostDetails-MFT" onclick="showhide('HostDetails-MFT');">-</a> <a name="HostDetails-MFT">MFT</a></h3>
    <div class="section" id="div-HostDetails-MFT">
      <table class="border">
        <thead>
          <tr class="border">
            <th class="border_header">#</th>
            <th class="border_header">パス</th>
            <th class="border_header">ヘッダフラグ</th>
            <th class="border_header">有効</th>
          </tr>
        </thead>
        <tbody>
          <tr class="border">
            <td class="border" rowspan="1">1</td>
            <td class="border">[PowerSploitのパス]\lsass_[lsassのPID].dmp</td>
            <td class="border">FILE</td>
            <td class="border">ALLOCATED</td>
          </tr>
        </tbody>
      </table>
    </div>
  <h3 class="subsection"><a href="#HostDetails-Prefetch" class="collapse" id="a-HostDetails-Prefetch" onclick="showhide('HostDetails-Prefetch');">-</a> <a name="HostDetails-Prefetch">Prefetch</a></h3>
    <div class="section" id="div-HostDetails-Prefetch">
      <table class="border">
        <thead>
          <tr class="border">
            <th class="border_header">#</th>
            <th class="border_header">Prefetchファイル</th>
            <th class="border_header">プロセス名</th>
            <th class="border_header">プロセスパス</th>
            <th class="border_header">ログから得られる情報</th>
          </tr>
        </thead>
        <tbody>
          <tr class="border">
            <td class="border" rowspan="1">1</td>
            <td class="border">POWERSHELL.EXE-[文字列].pf</td>
            <td class="border">POWERSHELL.EXE</td>
            <td class="border">\VOLUME{[GUID]}\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</td>
            <td class="border">Last Run Time (最終実行日時)</td>
          </tr>
        </tbody>
      </table>
    </div>
  <h3 class="subsection"><a href="#HostDetails-UserAssist" class="collapse" id="a-HostDetails-UserAssist" onclick="showhide('HostDetails-UserAssist');">-</a> <a name="HostDetails-UserAssist">UserAssist</a></h3>
    <div class="section" id="div-HostDetails-UserAssist">
      <table class="border">
        <thead>
          <tr class="border">
            <th class="border_header">#</th>
            <th class="border_header">レジストリエントリ</th>
            <th class="border_header">ログから得られる情報</th>
          </tr>
        </thead>
        <tbody>
          <tr class="border">
            <td class="border" rowspan="1">1</td>
            <td class="border">\REGISTRY\USER\[ユーザーSID]\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{[GUID]}\Count\{[GUID]}\JvaqbjfCbjreFuryy\i1.0\cbjrefuryy.rkr</td>
            <td class="border">初回実行日時、累計実行回数</td>
          </tr>
        </tbody>
      </table>
    </div>
  <h3 class="subsection"><a href="#HostDetails-USNJournal" class="collapse" id="a-HostDetails-USNJournal" onclick="showhide('HostDetails-USNJournal');">-</a> <a name="HostDetails-USNJournal">USNジャーナル</a></h3>
    <div class="section" id="div-HostDetails-USNJournal">
      <table class="border">
        <thead>
          <tr class="border">
            <th class="border_header">#</th>
            <th class="border_header">ファイル名</th>
            <th class="border_header">処理</th>
            <th class="border_header">属性</th>
          </tr>
        </thead>
        <tbody>
          <tr class="border">
            <td class="border" rowspan="8">1</td>
            <td class="border">[ランダム文字列].ps1</td>
            <td class="border">FILE_CREATE</td>
            <td class="border">archive</td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">[ランダム文字列].ps1</td>
            <td class="border">DATA_EXTEND+FILE_CREATE</td>
            <td class="border">archive</td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">[ランダム文字列].ps1</td>
            <td class="border">CLOSE+DATA_EXTEND+FILE_CREATE</td>
            <td class="border">archive</td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">[ランダム文字列].psm1</td>
            <td class="border">FILE_CREATE</td>
            <td class="border">archive</td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">[ランダム文字列].psm1</td>
            <td class="border">DATA_EXTEND+FILE_CREATE</td>
            <td class="border">archive</td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">[ランダム文字列].psm1</td>
            <td class="border">CLOSE+DATA_EXTEND+FILE_CREATE</td>
            <td class="border">archive</td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">[ランダム文字列].ps1</td>
            <td class="border">CLOSE+FILE_DELETE</td>
            <td class="border">archive</td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">[ランダム文字列].psm1</td>
            <td class="border">CLOSE+FILE_DELETE</td>
            <td class="border">archive</td>
          </tr>
          <tr class="border">
            <td class="border" rowspan="2">2</td>
            <td class="border">ConsoleHost_history.txt</td>
            <td class="border">DATA_EXTEND</td>
            <td class="border">archive</td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">ConsoleHost_history.txt</td>
            <td class="border">CLOSE+DATA_EXTEND</td>
            <td class="border">archive</td>
          </tr>
          <tr class="border">
            <td class="border" rowspan="4">3</td>
            <td class="border">lsass_[lsassのPID].dmp</td>
            <td class="border">FILE_CREATE</td>
            <td class="border">archive</td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">lsass_[lsassのPID].dmp</td>
            <td class="border">DATA_EXTEND+FILE_CREATE</td>
            <td class="border">archive</td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">lsass_[lsassのPID].dmp</td>
            <td class="border">DATA_EXTEND+DATA_OVERWRITE+FILE_CREATE</td>
            <td class="border">archive</td>
          </tr>
          <tr class="border">
            <!-- rowspan -->
            <td class="border">lsass_[lsassのPID].dmp</td>
            <td class="border">CLOSE+DATA_EXTEND+DATA_OVERWRITE+FILE_CREATE</td>
            <td class="border">archive</td>
          </tr>
        </tbody>
      </table>
    </div>
</div>
  </body>
</html>
